```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>", 
  warning = F,
  message = F
)
```

# Introduction {.unnumbered}

A model nested within another model is one where the nested model has a subset of the variables in the larger model. This article will visualize these models using a simple case where the nested model has one $x$ variable, and the full model has two $x$ variables.

We start by defining Model \ref{ypredbyx1}

\begin{align}
y =& \beta_1 x_1 + \beta_0 +\epsilon \label{ypredbyx1}
\end{align}

Model \ref{ypredbyx1} is nested within Model \ref{ypredbyx1x2} with two $x$ variables;

\begin{align}
y =& \beta'_1 x_1 +\beta'_2 x_2 + \beta'_0 +\epsilon' \label{ypredbyx1x2}
\end{align}

This article will demonstrate how to visualize the nested model inside a regression surface of Model \ref{ypredbyx1x2} using the R package __regress3d__. Two observations emerge from this exercise.

1.  The estimated values for $y$ from the nested model are identical to the estimated values of the full model in the direction of Model \ref{x1predbyx2}: the best fit line for $x_2$ estimated by $x_1$.
\begin{align}
  x_2 =& \gamma_{1} x_1 + \gamma_{0} +\epsilon_{\gamma} \label{x1predbyx2}
\end{align}
2.  The estimated standard errors for $y$ from the nested model are **not** identical to the estimated standard errors for $y$ for the full model in the direction of the best fit line for the model.

Therefore, the estimated values for the nested model can be understood as a direction in the regression surface of the larger model. The coefficient $\beta_1$ in Model \ref{ypredbyx1} is the **joint** effect of $x_1$ and $x_2$ where the relative contributions of $x_1$ and $x_2$ are defined by Model \ref{x1predbyx2}. This occurs despite the fact that Model \ref{ypredbyx1} does not use any information from $x_2$ to estimate the $y$ values.

Specifically, for every unit change in $x_1$ **and** $\gamma_{1}$ change in $x_2$, we see a $\beta_1$ change in $y$.

These facts can be useful when we have data for additional variables but choose not to include them in a model. The choice to exclude certain variables, despite having data for them, is often made in the name of parsimony for the model. When we exclude variables because we cannot collect data for them, these facts will be at best a theoretical exercise.

## Setup

Three R packages are needed for this exercise:

-   **plotly** and **regress3d** to plot regression surfaces in 3 dimensions.
-   **stargazer** to create regression tables.

```{r, include = T}
library(regress3d)
library(plotly)
library(stargazer)
```

## Data

The data used for this example is demographic and voting measures for all counties in the state of Louisiana in 2016. We could use data for all counties in the US, but limiting the analysis to Louisiana will highlight the differences in standard errors for Model \ref{ypredbyx1} and Model \ref{ypredbyx1x2}.

-   `prcnt_GOP16`:  the percent of the county that voted for Donald Trump in 2016,
-   `median_income16_1k`: median income measured in units of \$1,000 to improve the legibility of the results, and
-   `prcnt_black`: the percent of the county that identified as Black.

```{r, include = F}
la_counties <- subset(county_data, state_abbrv == "LA")
```

## Estimating the Models in R

We start by defining Model \ref{ypredbyx1} in R.

\begin{align*}
y =& \beta_1 x_1 + \beta_0 +\epsilon \\
\text{r-shift} =& \beta_1*\text{median-income16-1k} + \beta_0 + \epsilon
\end{align*}

```{r}
model1 <- lm(prcnt_GOP16 ~ median_income16_1k,  data = la_counties)
```

Model \ref{ypredbyx1} is nested within Model \ref{ypredbyx1x2} with two $x$ variables;

\begin{align*}
y =& \beta'_1 x_1 +\beta'_2 x_2 + \beta'_0 +\epsilon' \\
\text{r-shift} =& \beta'_1*\text{median-income16} +\beta'_2*\text{% Black} + \beta'_0 + \epsilon'

\end{align*}

```{r}
model2 <- lm(prcnt_GOP16 ~ median_income16_1k + prcnt_black, data = la_counties)
```

Finally, we need to define Model \ref{x1predbyx2}. This model will define the direction Model \ref{ypredbyx1} takes in the regression surface for Model \ref{ypredbyx1x2}.

\begin{align*}
x_2 =& \beta_1 x_1 + \beta_0 +\epsilon \\
\text{% Black} =& \beta_1*\text{median-income16-1k} + \beta_0 + \epsilon
\end{align*}

```{r}
model3 <- lm(prcnt_black ~ median_income16_1k, data = la_counties)
```


